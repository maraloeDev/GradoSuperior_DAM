CREATE TABLE EMPLEADO(
    NSS CHAR(9) NOT NULL,
    NOMBRE VARCHAR2(20) NOT NULL,
    APELLIDOS VARCHAR2(20) NOT NULL,
    FECHA_NAC DATE,
    DIRECCION VARCHAR2(30)	check(DIRECCION IN ('Calle', 'n', 'CP', 'poblacion')),
    SEXO CHAR(1)		check(SEXO in('H', 'M')),
    SALARIO NUMBER(6,2) NOT NULL,
    COD_DEP CHAR(3),
    CONSTRAINT PKNSS	PRIMARY KEY (NSS)
);
CREATE TABLE DEPARTAMENTO(
    COD_DEP CHAR(3) NOT NULL,
    NOMBRE_DEP VARCHAR2(30),
    NSS_GERENTE CHAR(9),
    CONSTRAINT PKCOD_DEP	PRIMARY KEY (COD_DEP)
);

CREATE TABLE PROYECTO(
    COD_PROY INTEGER NOT NULL,
    NOMBRE_PROY VARCHAR2(30) NOT NULL,
    LUGAR VARCHAR2(20),
    COD_DEP CHAR(3),
    CONSTRAINT PKCOD_PROY	PRIMARY KEY (COD_PROY)
);
CREATE TABLE TRABAJA_EN(
    NSS CHAR(9) NOT NULL,
    COD_PROY INTEGER NOT NULL,
    HORAS NUMBER(4,1),
    PRIMARY KEY(NSS,COD_PROY)
);


ALTER TABLE DEPARTAMENTO
ADD CONSTRAINT FKNSS	FOREIGN KEY(NSS_GERENTE) REFERENCES DEPARTAMENTO(COD_DEP);
ALTER TABLE DEPARTAMENTO
ADD CONSTRAINT PKNSS1	FOREIGN KEY(NSS_GERENTE) REFERENCES EMPLEADO(NSS);

ALTER TABLE EMPLEADO 
ADD CONSTRAINT	FKCODDEP	FOREIGN KEY(COD_DEP) REFERENCES EMPLEADO(NSS);

ALTER TABLE EMPLEADO
ADD CONSTRAINT FKCODDEP1	FOREIGN KEY(COD_DEP) REFERENCES DEPARTAMENTO(COD_DEP);

ALTER TABLE TRABAJA_EN
ADD CONSTRAINT FKNSSCODPROY	FOREIGN KEY(NSS,COD_PROY)	REFERENCES PROYECTO (NSS,COD_PROY);

ALTER TABLE PROYECTO 
ADD CONSTRAINT FKCODDEPROY	FOREIGN KEY(COD_DEP) REFERENCES DEPARTAMENTO (COD_DEP);


ALTER TABLE PROYECTO
MODIFY(
    NOMBRE_PROY varchar2(60)
);

ALTER TABLE EMPLEADO
ADD CONSTRAINT SEXO check(SEXO in('H', 'M'));

ALTER TABLE EMPLEADO
ADD CONSTRAINT SALARIOMAX	CHECK (SALARIO >=0);

CREATE INDEX PKEMPLEADO
ON EMPLEADO (COD_DEP);

SELECT * FROM USER_INDEXES;
SELECT * FROM USER_TABLES;
SELECT * FROM USER_CONSTRAINTS;